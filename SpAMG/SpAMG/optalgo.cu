#include "optalgo.h"

OptAlgo::OptAlgo() {
    this->spgemm_algo = -1;
    this->spmv_algo = -1;
    this->d_row_blocks = nullptr; //adaptive防止重复计算，如果不是nullptr说明已经计算过rowblocks了
    this->block_count = 0;

    this->M = 0; //不是0说明矩阵特征已经计算过了
}

int OptAlgo::fill_row_blocks(bool fill, int rows_count, int *row_ptr, int *row_blocks)
{
    if (fill)
        row_blocks[0] = 0;

    int last_i = 0;
    int current_wg = 1;
    unsigned int nnz_sum = 0;

    // #pragma omp for: 不能并行化！上下是有关联的
    for (int i = 1; i <= rows_count; i++)
    {
        nnz_sum += row_ptr[i] - row_ptr[i - 1];

        if (nnz_sum == 64u)
        {
        last_i = i;

        if (fill)
            row_blocks[current_wg] = i;
        current_wg++;
        nnz_sum = 0;
        }
        else if (nnz_sum > 64u)
        {
        if (i - last_i > 1)
        {
            if (fill)
            row_blocks[current_wg] = i - 1;
            current_wg++;
            i--;
        }
        else
        {
            if (fill)
            row_blocks[current_wg] = i;
            current_wg++;
        }

        last_i = i;
        nnz_sum = 0;
        }
        else if (i - last_i > 64u)
        {
        last_i = i;
        if (fill)
            row_blocks[current_wg] = i;
        current_wg++;
        nnz_sum = 0;
        }
    }

    if (fill)
        row_blocks[current_wg] = rows_count;
    return current_wg;
}

#include <stdio.h>
void OptAlgo::calc_d_row_blocks(int _M, int *r)
{
    if(this->d_row_blocks != nullptr) {
        return;
    }

    const int blocks_count = fill_row_blocks(false, _M, r, nullptr);
    // printf("returned blocks_count = %d\n", blocks_count);
    this->block_count = blocks_count;
    int* row_blocks = new int[blocks_count + 1];
    fill_row_blocks(true, _M, r, row_blocks);

    // int *d_row_blocks;
    cudaMalloc(&(this->d_row_blocks), (blocks_count + 1) * sizeof(int));
    cudaMemcpy(this->d_row_blocks, row_blocks, sizeof(int) * (blocks_count + 1), cudaMemcpyHostToDevice);
    delete row_blocks;
}

void softmax(double *x, int size, double *result) {
    double max = x[0];
    for (int i = 1; i < size; ++i) {
        if (x[i] > max)
            max = x[i];
    }
    double sum = 0.0;
    for (int i = 0; i < size; ++i) {
        result[i] = exp(x[i] - max);
        sum += result[i];
    }
    for (int i = 0; i < size; ++i)
        result[i] /= sum;
}

void score310(double * input, double * output) 
{
    double var0[3];
    double var1;
    if (input[6] > 824.7531475000002) {
        if (input[7] > 0.043029500000000005) {
            var1 = -1.0811936910869087;
        } else {
            if (input[13] > 29.500000000000004) {
                var1 = -1.2861007508487001;
            } else {
                var1 = -1.1584512647663843;
            }
        }
    } else {
        if (input[16] > 0.14128900000000003) {
            if (input[11] > 29316.500000000004) {
                var1 = -1.2037300735484233;
            } else {
                var1 = -1.3498483558149763;
            }
        } else {
            if (input[4] > 47.50000000000001) {
                var1 = -1.3300757151598468;
            } else {
                var1 = -1.3797823776941536;
            }
        }
    }
    double var2;
    if (input[6] > 947.2322155) {
        if (input[7] > 0.021545500000000006) {
            var2 = 0.16376987257261366;
        } else {
            if (input[14] > 1.4656305000000003) {
                var2 = 0.020705055433531617;
            } else {
                var2 = 0.17911084666732713;
            }
        }
    } else {
        if (input[4] > 47.50000000000001) {
            if (input[16] > 0.18597600000000003) {
                var2 = 0.11135563755267286;
            } else {
                var2 = -0.017281758246520933;
            }
        } else {
            if (input[15] > 355.357366) {
                var2 = 0.026021700201713644;
            } else {
                var2 = -0.07257969851324401;
            }
        }
    }
    double var3;
    if (input[6] > 379.78352200000006) {
        if (input[10] > 2470.5000000000005) {
            var3 = -0.032234697205170276;
        } else {
            if (input[13] > 286.00000000000006) {
                var3 = -0.0006224027899123978;
            } else {
                var3 = 0.11849553582724104;
            }
        }
    } else {
        if (input[14] > 28.806911000000003) {
            if (input[11] > 394491.00000000006) {
                var3 = -0.05473563255908973;
            } else {
                var3 = 0.05232485661612355;
            }
        } else {
            if (input[2] > 28351.500000000004) {
                var3 = -0.03611973581089047;
            } else {
                var3 = -0.07443906037955214;
            }
        }
    }
    double var4;
    if (input[6] > 947.2322155) {
        if (input[10] > 1799.0000000000002) {
            var4 = 0.0022375176913085;
        } else {
            if (input[13] > 326.00000000000006) {
                var4 = -0.01393766275439694;
            } else {
                var4 = 0.12300083507293053;
            }
        }
    } else {
        if (input[4] > 41.50000000000001) {
            if (input[16] > 0.07458300000000001) {
                var4 = 0.056795305747196816;
            } else {
                var4 = -0.022205964008456324;
            }
        } else {
            if (input[15] > 355.357366) {
                var4 = 0.0208971291565024;
            } else {
                var4 = -0.07005032630965757;
            }
        }
    }
    double var5;
    if (input[6] > 508.97368550000004) {
        if (input[10] > 1377.5000000000002) {
            if (input[6] > 3176.3546605000006) {
                var5 = 0.04738537123377172;
            } else {
                var5 = -0.0445185692078882;
            }
        } else {
            if (input[13] > 326.00000000000006) {
                var5 = -0.007909347860443245;
            } else {
                var5 = 0.10172170611249598;
            }
        }
    } else {
        if (input[14] > 28.196559000000004) {
            if (input[11] > 419581.50000000006) {
                var5 = -0.05403003126320455;
            } else {
                var5 = 0.04397029850484758;
            }
        } else {
            var5 = -0.048267816976272845;
        }
    }
    double var6;
    if (input[6] > 947.2322155) {
        if (input[7] > 0.043029500000000005) {
            var6 = 0.11364571855385985;
        } else {
            if (input[13] > 30.500000000000004) {
                var6 = 0.007541691348897789;
            } else {
                var6 = 0.08879481821029264;
            }
        }
    } else {
        if (input[4] > 41.50000000000001) {
            if (input[16] > 0.07458300000000001) {
                var6 = 0.04760489392712364;
            } else {
                var6 = -0.018160921206328548;
            }
        } else {
            if (input[15] > 355.357366) {
                var6 = 0.016352476774855147;
            } else {
                var6 = -0.06534950844381325;
            }
        }
    }
    double var7;
    if (input[6] > 379.78352200000006) {
        if (input[10] > 2515.0000000000005) {
            var7 = -0.02852355456840331;
        } else {
            if (input[7] > 0.0505625) {
                var7 = 0.10415098040228431;
            } else {
                var7 = 0.045708221792140985;
            }
        }
    } else {
        if (input[14] > 28.806911000000003) {
            if (input[11] > 394491.00000000006) {
                var7 = -0.04642263405575325;
            } else {
                var7 = 0.041025860716824965;
            }
        } else {
            if (input[2] > 28351.500000000004) {
                var7 = -0.023128441014528028;
            } else {
                var7 = -0.06592381306832776;
            }
        }
    }
    double var8;
    if (input[6] > 947.2322155) {
        if (input[18] > 72.53555300000001) {
            var8 = 0.0073627798225941125;
        } else {
            if (input[10] > 2007.0000000000002) {
                var8 = 0.003290291734983113;
            } else {
                var8 = 0.08877787698671089;
            }
        }
    } else {
        if (input[4] > 41.50000000000001) {
            if (input[0] > 580.5000000000001) {
                var8 = -0.01677645690606837;
            } else {
                var8 = 0.03987275319729365;
            }
        } else {
            if (input[15] > 355.357366) {
                var8 = 0.012730988399213737;
            } else {
                var8 = -0.06084821142264188;
            }
        }
    }
    double var9;
    if (input[6] > 947.2322155) {
        if (input[0] > 11473.000000000002) {
            var9 = -0.020779220005978677;
        } else {
            if (input[13] > 286.00000000000006) {
                var9 = -0.0028012469096051077;
            } else {
                var9 = 0.07431474357170091;
            }
        }
    } else {
        if (input[4] > 38.50000000000001) {
            if (input[10] > 4130.500000000001) {
                var9 = -0.04687935508030092;
            } else {
                var9 = 0.006737254927286324;
            }
        } else {
            if (input[15] > 583.3005220000001) {
                var9 = 0.014730546827286745;
            } else {
                var9 = -0.059278884170726145;
            }
        }
    }
    double var10;
    if (input[6] > 379.78352200000006) {
        if (input[10] > 4130.500000000001) {
            var10 = -0.0444728021301691;
        } else {
            if (input[7] > 0.0505625) {
                var10 = 0.08602378757246103;
            } else {
                var10 = 0.032299842186389226;
            }
        }
    } else {
        if (input[11] > 19778.000000000004) {
            if (input[7] > 0.0022655000000000006) {
                var10 = 0.023131063942952994;
            } else {
                var10 = -0.03186825114752178;
            }
        } else {
            if (input[4] > 447.00000000000006) {
                var10 = 0.057824723590982466;
            } else {
                var10 = -0.06155130245166664;
            }
        }
    }
    double var11;
    if (input[9] > 34.72079600000001) {
        if (input[2] > 2414.5000000000005) {
            if (input[2] > 55569.50000000001) {
                var11 = -0.926025669904686;
            } else {
                var11 = -0.8662810410007414;
            }
        } else {
            if (input[11] > 26363.000000000004) {
                var11 = -0.8947817239072164;
            } else {
                var11 = -0.6974584672620756;
            }
        }
    } else {
        if (input[0] > 4866.500000000001) {
            var11 = -0.8192880759563387;
        } else {
            if (input[15] > 286.47996500000005) {
                var11 = -0.8930474103732098;
            } else {
                var11 = -0.6896983616173118;
            }
        }
    }
    double var12;
    if (input[9] > 34.72079600000001) {
        if (input[2] > 3031.0000000000005) {
            if (input[11] > 2082.5000000000005) {
                var12 = -0.08071498569267982;
            } else {
                var12 = 0.025872804642814745;
            }
        } else {
            if (input[11] > 43243.50000000001) {
                var12 = -0.1151635025037739;
            } else {
                var12 = 0.09992982850458865;
            }
        }
    } else {
        if (input[0] > 4866.500000000001) {
            var12 = 0.0011020617967722678;
        } else {
            if (input[13] > 95.50000000000001) {
                var12 = -0.051785997787501085;
            } else {
                var12 = 0.11806670568680283;
            }
        }
    }
    double var13;
    if (input[9] > 48.851445000000005) {
        if (input[2] > 4095.5000000000005) {
            if (input[2] > 37290.50000000001) {
                var13 = -0.09913208190939231;
            } else {
                var13 = -0.04153300948492131;
            }
        } else {
            if (input[11] > 43243.50000000001) {
                var13 = -0.11119114294304569;
            } else {
                var13 = 0.09569140566167712;
            }
        }
    } else {
        if (input[11] > 20629.000000000004) {
            if (input[13] > 95.50000000000001) {
                var13 = -0.0747911430738363;
            } else {
                var13 = 0.03681435741403677;
            }
        } else {
            var13 = 0.10855554226890951;
        }
    }
    double var14;
    if (input[9] > 43.624963) {
        if (input[2] > 30315.500000000004) {
            var14 = -0.08903023460928179;
        } else {
            if (input[11] > 43243.50000000001) {
                var14 = -0.09714065066605974;
            } else {
                var14 = 0.058159088174348665;
            }
        }
    } else {
        if (input[11] > 20134.500000000004) {
            if (input[15] > 286.47996500000005) {
                var14 = -0.07580434561315794;
            } else {
                var14 = 0.03394842833767871;
            }
        } else {
            if (input[16] > 0.0006510000000000001) {
                var14 = 0.10873016406728866;
            } else {
                var14 = -0.02157581657751762;
            }
        }
    }
    double var15;
    if (input[9] > 48.851445000000005) {
        if (input[2] > 30315.500000000004) {
            var15 = -0.08641239632680277;
        } else {
            if (input[11] > 42313.00000000001) {
                var15 = -0.09020265334776618;
            } else {
                var15 = 0.052341331700231614;
            }
        }
    } else {
        if (input[11] > 20134.500000000004) {
            if (input[14] > 37.19010550000001) {
                var15 = -0.06769358303107832;
            } else {
                var15 = 0.030585196335873227;
            }
        } else {
            if (input[16] > 0.0006510000000000001) {
                var15 = 0.10084295584177723;
            } else {
                var15 = -0.01825711538995484;
            }
        }
    }
    double var16;
    if (input[9] > 48.851445000000005) {
        if (input[2] > 30315.500000000004) {
            var16 = -0.08235560177899375;
        } else {
            if (input[11] > 42313.00000000001) {
                var16 = -0.08591749858686319;
            } else {
                var16 = 0.047812696373178885;
            }
        }
    } else {
        if (input[11] > 20134.500000000004) {
            if (input[13] > 95.50000000000001) {
                var16 = -0.06447153381787293;
            } else {
                var16 = 0.028137964165013886;
            }
        } else {
            if (input[16] > 0.0006510000000000001) {
                var16 = 0.09442557307225397;
            } else {
                var16 = -0.017844716496092556;
            }
        }
    }
    double var17;
    if (input[9] > 34.72079600000001) {
        if (input[2] > 30315.500000000004) {
            if (input[9] > 48.851445000000005) {
                var17 = -0.07879001506534693;
            } else {
                var17 = -0.0031992218297141003;
            }
        } else {
            if (input[11] > 43243.50000000001) {
                var17 = -0.08035810801976824;
            } else {
                var17 = 0.043345939080838496;
            }
        }
    } else {
        if (input[0] > 4866.500000000001) {
            var17 = -0.007745374391073015;
        } else {
            if (input[15] > 334.95224650000006) {
                var17 = -0.059616238194463114;
            } else {
                var17 = 0.08051677270363361;
            }
        }
    }
    double var18;
    if (input[9] > 36.78579050000001) {
        if (input[2] > 38301.50000000001) {
            if (input[9] > 47.43124000000001) {
                var18 = -0.07922182587971643;
            } else {
                var18 = -0.0007125782488946139;
            }
        } else {
            if (input[11] > 43243.50000000001) {
                var18 = -0.0784570592437648;
            } else {
                var18 = 0.034522217552403776;
            }
        }
    } else {
        if (input[0] > 4866.500000000001) {
            var18 = -0.005826939324890938;
        } else {
            if (input[15] > 111.11039650000002) {
                var18 = -0.01920312659886435;
            } else {
                var18 = 0.08020882607546276;
            }
        }
    }
    double var19;
    if (input[9] > 48.851445000000005) {
        if (input[2] > 9595.500000000002) {
            if (input[11] > 4342.500000000001) {
                var19 = -0.07527759385744325;
            } else {
                var19 = -0.020330795148759764;
            }
        } else {
            if (input[11] > 43243.50000000001) {
                var19 = -0.07271344695027519;
            } else {
                var19 = 0.0690392459423182;
            }
        }
    } else {
        if (input[13] > 48.50000000000001) {
            var19 = -0.023037536069095064;
        } else {
            if (input[0] > 3728.0000000000005) {
                var19 = 0.007200952890990213;
            } else {
                var19 = 0.08313501878222046;
            }
        }
    }
    double var20;
    if (input[4] > 50.50000000000001) {
        if (input[11] > 26363.000000000004) {
            if (input[8] > 4.342290000000001) {
                var20 = 0.011020694685611813;
            } else {
                var20 = -0.0684759387019412;
            }
        } else {
            if (input[2] > 33278.50000000001) {
                var20 = -0.04081952795442134;
            } else {
                var20 = 0.04178637395896501;
            }
        }
    } else {
        if (input[15] > 286.47996500000005) {
            var20 = -0.05704099706426781;
        } else {
            if (input[0] > 3728.0000000000005) {
                var20 = 0.0044333826093897214;
            } else {
                var20 = 0.0740142832869937;
            }
        }
    }
    double var21;
    if (input[11] > 66190.50000000001) {
        if (input[4] > 58.50000000000001) {
            if (input[0] > 405.50000000000006) {
                var21 = -1.0846327004412775;
            } else {
                var21 = -1.2948090188480517;
            }
        } else {
            if (input[17] > 0.4426550000000001) {
                var21 = -1.149331673846065;
            } else {
                var21 = -1.2562788926838;
            }
        }
    } else {
        if (input[0] > 5766.000000000001) {
            if (input[16] > 0.0006510000000000001) {
                var21 = -1.2306390069378192;
            } else {
                var21 = -1.137694413799913;
            }
        } else {
            var21 = -1.3132655138047287;
        }
    }
    double var22;
    if (input[11] > 52311.00000000001) {
        if (input[4] > 58.50000000000001) {
            if (input[0] > 405.50000000000006) {
                var22 = 0.12994039352701645;
            } else {
                var22 = -0.05476599663491699;
            }
        } else {
            if (input[14] > 3.509288) {
                var22 = 0.005458891813852149;
            } else {
                var22 = 0.1314725493309593;
            }
        }
    } else {
        if (input[0] > 6029.000000000001) {
            var22 = 0.04298989102965684;
        } else {
            if (input[0] > 1813.5000000000002) {
                var22 = -0.03977724070879462;
            } else {
                var22 = -0.0829164549632613;
            }
        }
    }
    double var23;
    if (input[11] > 113064.50000000001) {
        if (input[9] > 16.222576000000004) {
            if (input[0] > 324.50000000000006) {
                var23 = 0.11546856210077057;
            } else {
                var23 = -0.04447305466179248;
            }
        } else {
            var23 = 0.0111441272799185;
        }
    } else {
        if (input[0] > 6029.000000000001) {
            if (input[17] > 0.904499) {
                var23 = 0.09524649241530174;
            } else {
                var23 = 0.021792266839395284;
            }
        } else {
            if (input[18] > 24.130605000000003) {
                var23 = -0.032908955368718226;
            } else {
                var23 = -0.07801185413561533;
            }
        }
    }
    double var24;
    if (input[11] > 52311.00000000001) {
        if (input[11] > 394491.00000000006) {
            if (input[15] > 11.883893500000001) {
                var24 = 0.1179403552153042;
            } else {
                var24 = 0.014298440878018282;
            }
        } else {
            if (input[17] > 0.5402945000000001) {
                var24 = 0.07079056765241973;
            } else {
                var24 = -0.013935793107103994;
            }
        }
    } else {
        if (input[0] > 4087.5000000000005) {
            if (input[3] > 3.5000000000000004) {
                var24 = -0.04249082779862048;
            } else {
                var24 = 0.04588120127835825;
            }
        } else {
            var24 = -0.06902213406865187;
        }
    }
    double var25;
    if (input[11] > 83789.50000000001) {
        if (input[4] > 59.50000000000001) {
            if (input[0] > 405.50000000000006) {
                var25 = 0.09604096311326608;
            } else {
                var25 = -0.048452134710702505;
            }
        } else {
            if (input[14] > 3.509288) {
                var25 = 0.009117800175222941;
            } else {
                var25 = 0.12229141555375678;
            }
        }
    } else {
        if (input[0] > 3513.0000000000005) {
            if (input[17] > 0.904499) {
                var25 = 0.06285308887711138;
            } else {
                var25 = -0.010892199820704022;
            }
        } else {
            var25 = -0.06486795974835492;
        }
    }
    double var26;
    if (input[10] > 1799.0000000000002) {
        if (input[18] > 18.840421500000005) {
            if (input[5] > 6.1412580000000005) {
                var26 = 0.0973917392659892;
            } else {
                var26 = 0.027355337124818902;
            }
        } else {
            if (input[16] > 0.0006755000000000001) {
                var26 = -0.040604476439074694;
            } else {
                var26 = 0.05518876880779788;
            }
        }
    } else {
        if (input[11] > 113064.50000000001) {
            var26 = 0.05062348037364344;
        } else {
            if (input[18] > 15.671460500000002) {
                var26 = -0.03449872600373057;
            } else {
                var26 = -0.07413063781587284;
            }
        }
    }
    double var27;
    if (input[10] > 1377.5000000000002) {
        if (input[18] > 17.455612500000004) {
            if (input[5] > 6.1412580000000005) {
                var27 = 0.0839253872221218;
            } else {
                var27 = 0.018262862009172202;
            }
        } else {
            if (input[16] > 0.0006755000000000001) {
                var27 = -0.048532818337751485;
            } else {
                var27 = 0.05167867644335571;
            }
        }
    } else {
        if (input[11] > 113064.50000000001) {
            var27 = 0.04400655452778247;
        } else {
            if (input[18] > 15.671460500000002) {
                var27 = -0.03657548970884417;
            } else {
                var27 = -0.07342660951997516;
            }
        }
    }
    double var28;
    if (input[11] > 52311.00000000001) {
        if (input[2] > 140092.00000000003) {
            if (input[3] > 53.50000000000001) {
                var28 = -0.08440850729690007;
            } else {
                var28 = 0.07820911619439193;
            }
        } else {
            if (input[15] > 36.158524500000006) {
                var28 = 0.033721543550915146;
            } else {
                var28 = -0.061343362077972176;
            }
        }
    } else {
        if (input[0] > 1813.5000000000002) {
            if (input[13] > 77.50000000000001) {
                var28 = 0.0839434374245857;
            } else {
                var28 = -0.01233074839388628;
            }
        } else {
            var28 = -0.06847497228918041;
        }
    }
    double var29;
    if (input[1] > 1995.5000000000002) {
        if (input[18] > 17.455612500000004) {
            if (input[2] > 13898.000000000002) {
                var29 = 0.056558666064648835;
            } else {
                var29 = -0.00790686467766793;
            }
        } else {
            if (input[16] > 0.0006755000000000001) {
                var29 = -0.04991649388149825;
            } else {
                var29 = 0.04258052052584977;
            }
        }
    } else {
        if (input[15] > 809.2373645000001) {
            if (input[0] > 324.50000000000006) {
                var29 = 0.05924220610208402;
            } else {
                var29 = -0.06035561126728603;
            }
        } else {
            var29 = -0.06581061116988964;
        }
    }
    double var30;
    if (input[1] > 1813.5000000000002) {
        if (input[18] > 17.455612500000004) {
            if (input[2] > 13898.000000000002) {
                var30 = 0.05129826746300488;
            } else {
                var30 = -0.009231600899434712;
            }
        } else {
            if (input[16] > 0.0006755000000000001) {
                var30 = -0.047714341306206935;
            } else {
                var30 = 0.03838130064039802;
            }
        }
    } else {
        if (input[15] > 319.61432700000006) {
            if (input[0] > 411.50000000000006) {
                var30 = 0.09155300864801175;
            } else {
                var30 = -0.0382758036988924;
            }
        } else {
            var30 = -0.06885780796494868;
        }
    }
    double arr[] = {var1 + var2 + var3 + var4 + var5 + var6 + var7 + var8 + var9 + var10, var11 + var12 + var13 + var14 + var15 + var16 + var17 + var18 + var19 + var20, var21 + var22 + var23 + var24 + var25 + var26 + var27 + var28 + var29 + var30};
    softmax(arr, 3, var0);
    memcpy(output, var0, 3 * sizeof(double));
}

void score320_spmv(double * input, double * output) 
{
    double var0[3];
    double var1;
    if (input[2] > 110441.50000000001) {
        if (input[7] > 0.06517100000000002) {
            if (input[9] > 712.2854185000001) {
                var1 = -1.2676791936417686;
            } else {
                var1 = -1.4816513382910728;
            }
        } else {
            if (input[5] > 8.462831500000002) {
                var1 = -1.2227932835771342;
            } else {
                var1 = -1.4240778146083963;
            }
        }
    } else {
        if (input[4] > 673.5000000000001) {
            if (input[6] > 322.3525620000001) {
                var1 = -1.167906976672165;
            } else {
                var1 = -1.3471002122026012;
            }
        } else {
            if (input[2] > 61398.00000000001) {
                var1 = -1.4551908199473493;
            } else {
                var1 = -1.522674654992272;
            }
        }
    }
    double var2;
    if (input[2] > 88963.00000000001) {
        if (input[7] > 0.13478650000000003) {
            if (input[8] > 0.7309130000000001) {
                var2 = 0.07834668885568427;
            } else {
                var2 = -0.06857751336723783;
            }
        } else {
            if (input[5] > 8.3168555) {
                var2 = 0.15505910072331097;
            } else {
                var2 = -0.0007338270029105905;
            }
        }
    } else {
        if (input[4] > 560.5000000000001) {
            if (input[3] > 0.000000000000000000000000000000000010000000180025095) {
                var2 = 0.19590770584084272;
            } else {
                var2 = -0.025277458568904995;
            }
        } else {
            if (input[2] > 48500.00000000001) {
                var2 = -0.044323536284899684;
            } else {
                var2 = -0.08390637900895216;
            }
        }
    }
    double var3;
    if (input[2] > 88963.00000000001) {
        if (input[7] > 0.13478650000000003) {
            if (input[8] > 0.7309130000000001) {
                var3 = 0.07187998641301872;
            } else {
                var3 = -0.0660459481733202;
            }
        } else {
            if (input[5] > 8.3168555) {
                var3 = 0.12921734845777808;
            } else {
                var3 = -0.002356327468631778;
            }
        }
    } else {
        if (input[4] > 560.5000000000001) {
            if (input[3] > 0.000000000000000000000000000000000010000000180025095) {
                var3 = 0.16178120394370973;
            } else {
                var3 = -0.024942844470588695;
            }
        } else {
            if (input[2] > 61398.00000000001) {
                var3 = -0.03005461663001382;
            } else {
                var3 = -0.08037096860214904;
            }
        }
    }
    double var4;
    if (input[2] > 88963.00000000001) {
        if (input[1] > 865.0000000000001) {
            if (input[5] > 6.3827445) {
                var4 = 0.10556767909502435;
            } else {
                var4 = -0.03016081391468022;
            }
        } else {
            if (input[0] > 860.0000000000001) {
                var4 = -0.06064216110236786;
            } else {
                var4 = 0.06543781920723506;
            }
        }
    } else {
        if (input[4] > 560.5000000000001) {
            if (input[3] > 0.000000000000000000000000000000000010000000180025095) {
                var4 = 0.13803307661864989;
            } else {
                var4 = -0.02620371491283065;
            }
        } else {
            if (input[2] > 48500.00000000001) {
                var4 = -0.037589355347428785;
            } else {
                var4 = -0.07980327694550952;
            }
        }
    }
    double var5;
    if (input[2] > 88963.00000000001) {
        if (input[7] > 0.13478650000000003) {
            if (input[8] > 0.7309130000000001) {
                var5 = 0.0610522409500007;
            } else {
                var5 = -0.06350292995951777;
            }
        } else {
            if (input[5] > 8.462831500000002) {
                var5 = 0.09864353186765652;
            } else {
                var5 = -0.0037352626444047336;
            }
        }
    } else {
        if (input[4] > 560.5000000000001) {
            if (input[4] > 875.5000000000001) {
                var5 = 0.13286406571224216;
            } else {
                var5 = 0.04553206593147032;
            }
        } else {
            if (input[2] > 48500.00000000001) {
                var5 = -0.0345015563103137;
            } else {
                var5 = -0.0780914264509599;
            }
        }
    }
    double var6;
    if (input[2] > 72235.50000000001) {
        if (input[5] > 6.032675000000001) {
            if (input[1] > 1220.5000000000002) {
                var6 = 0.08432302211686167;
            } else {
                var6 = -0.020487811567245023;
            }
        } else {
            if (input[4] > 1179.5000000000002) {
                var6 = 0.17870962530496193;
            } else {
                var6 = -0.05250972663242594;
            }
        }
    } else {
        if (input[4] > 560.5000000000001) {
            if (input[3] > 0.000000000000000000000000000000000010000000180025095) {
                var6 = 0.10977962748107083;
            } else {
                var6 = -0.0312785909842578;
            }
        } else {
            if (input[2] > 48500.00000000001) {
                var6 = -0.042823750989328314;
            } else {
                var6 = -0.07656151839714152;
            }
        }
    }
    double var7;
    if (input[2] > 72235.50000000001) {
        if (input[5] > 8.462831500000002) {
            if (input[1] > 789.5000000000001) {
                var7 = 0.07685767159596285;
            } else {
                var7 = -0.050867906324212335;
            }
        } else {
            if (input[4] > 1179.5000000000002) {
                var7 = 0.16246693204647128;
            } else {
                var7 = -0.03833262054483783;
            }
        }
    } else {
        if (input[4] > 560.5000000000001) {
            if (input[3] > 0.000000000000000000000000000000000010000000180025095) {
                var7 = 0.10021823809739938;
            } else {
                var7 = -0.030741096191182593;
            }
        } else {
            if (input[2] > 48500.00000000001) {
                var7 = -0.039760860574603006;
            } else {
                var7 = -0.07517914175127494;
            }
        }
    }
    double var8;
    if (input[2] > 72235.50000000001) {
        if (input[5] > 8.735073000000002) {
            if (input[1] > 789.5000000000001) {
                var8 = 0.07014089630673008;
            } else {
                var8 = -0.04824271119600583;
            }
        } else {
            if (input[2] > 707217.5000000001) {
                var8 = 0.14006626685638005;
            } else {
                var8 = -0.04067145639928873;
            }
        }
    } else {
        if (input[4] > 560.5000000000001) {
            if (input[5] > 4.280187000000001) {
                var8 = 0.09213320927049876;
            } else {
                var8 = -0.037593654251699145;
            }
        } else {
            if (input[2] > 41262.00000000001) {
                var8 = -0.04201546066079071;
            } else {
                var8 = -0.07469578349403819;
            }
        }
    }
    double var9;
    if (input[2] > 72235.50000000001) {
        if (input[9] > 1221.2570950000002) {
            if (input[5] > 8.058800500000002) {
                var9 = 0.11056252070349504;
            } else {
                var9 = 0.14014073793751133;
            }
        } else {
            if (input[5] > 11.449510000000002) {
                var9 = 0.051824078071894056;
            } else {
                var9 = -0.02793327524445255;
            }
        }
    } else {
        if (input[4] > 560.5000000000001) {
            if (input[6] > 405.3128940000001) {
                var9 = 0.09120304167366348;
            } else {
                var9 = 0.005185031317298524;
            }
        } else {
            if (input[2] > 41262.00000000001) {
                var9 = -0.039509292428089114;
            } else {
                var9 = -0.073671845283931;
            }
        }
    }
    double var10;
    if (input[2] > 72235.50000000001) {
        if (input[7] > 0.11102800000000002) {
            if (input[8] > 0.7309130000000001) {
                var10 = 0.04543560762481316;
            } else {
                var10 = -0.05823022310720813;
            }
        } else {
            if (input[5] > 11.227593500000003) {
                var10 = 0.0659231353677313;
            } else {
                var10 = -0.004581448273769234;
            }
        }
    } else {
        if (input[4] > 560.5000000000001) {
            if (input[7] > 0.0008330000000000001) {
                var10 = 0.08432601275604862;
            } else {
                var10 = -0.011935134913800617;
            }
        } else {
            if (input[2] > 48500.00000000001) {
                var10 = -0.03168752127399318;
            } else {
                var10 = -0.07193023667861544;
            }
        }
    }
    double var11;
    if (input[2] > 72235.50000000001) {
        if (input[1] > 789.5000000000001) {
            if (input[5] > 11.030627) {
                var11 = 0.057830554283724536;
            } else {
                var11 = -0.005868751132140941;
            }
        } else {
            if (input[6] > 21087.558340000003) {
                var11 = 0.09973893636985151;
            } else {
                var11 = -0.05794165154848126;
            }
        }
    } else {
        if (input[4] > 467.00000000000006) {
            if (input[3] > 0.000000000000000000000000000000000010000000180025095) {
                var11 = 0.07475724413216402;
            } else {
                var11 = -0.04183501684292875;
            }
        } else {
            if (input[2] > 48500.00000000001) {
                var11 = -0.028709753373654386;
            } else {
                var11 = -0.07178838965636133;
            }
        }
    }
    double var12;
    if (input[2] > 61398.00000000001) {
        if (input[5] > 8.735073000000002) {
            if (input[7] > 0.04508550000000001) {
                var12 = -0.008991977447923304;
            } else {
                var12 = 0.05939507759123733;
            }
        } else {
            if (input[2] > 707217.5000000001) {
                var12 = 0.12201121837440615;
            } else {
                var12 = -0.041895235944914275;
            }
        }
    } else {
        if (input[4] > 467.00000000000006) {
            if (input[4] > 899.5000000000001) {
                var12 = 0.08655747972463221;
            } else {
                var12 = 0.016797767787874163;
            }
        } else {
            if (input[2] > 44615.00000000001) {
                var12 = -0.040463094661035925;
            } else {
                var12 = -0.07137493841919408;
            }
        }
    }
    double var13;
    if (input[2] > 61398.00000000001) {
        if (input[9] > 1221.2570950000002) {
            if (input[3] > 0.000000000000000000000000000000000010000000180025095) {
                var13 = 0.10180245715128951;
            } else {
                var13 = 0.06907656305273739;
            }
        } else {
            if (input[5] > 11.449510000000002) {
                var13 = 0.03802658198787309;
            } else {
                var13 = -0.03089062563260039;
            }
        }
    } else {
        if (input[4] > 449.50000000000006) {
            if (input[4] > 899.5000000000001) {
                var13 = 0.08420298045645495;
            } else {
                var13 = 0.015781095275568795;
            }
        } else {
            if (input[2] > 42252.50000000001) {
                var13 = -0.04004702892483737;
            } else {
                var13 = -0.07116434679791889;
            }
        }
    }
    double var14;
    if (input[2] > 61398.00000000001) {
        if (input[3] > 1.5000000000000002) {
            if (input[7] > 0.04508550000000001) {
                var14 = 0.0008000746358747569;
            } else {
                var14 = 0.0633046442134501;
            }
        } else {
            if (input[9] > 1388.295014) {
                var14 = 0.09449990124469812;
            } else {
                var14 = -0.007008950930585749;
            }
        }
    } else {
        if (input[4] > 382.50000000000006) {
            if (input[4] > 899.5000000000001) {
                var14 = 0.08123588186460319;
            } else {
                var14 = 0.012989346111371668;
            }
        } else {
            if (input[2] > 42252.50000000001) {
                var14 = -0.03954500226821287;
            } else {
                var14 = -0.07137173457778855;
            }
        }
    }
    double var15;
    if (input[2] > 61398.00000000001) {
        if (input[5] > 11.449510000000002) {
            if (input[7] > 0.023454500000000003) {
                var15 = 0.0012365800851763815;
            } else {
                var15 = 0.06019986238234131;
            }
        } else {
            if (input[2] > 707217.5000000001) {
                var15 = 0.10332062524678545;
            } else {
                var15 = -0.03410154484536059;
            }
        }
    } else {
        if (input[4] > 382.50000000000006) {
            if (input[3] > 0.000000000000000000000000000000000010000000180025095) {
                var15 = 0.05964429056632334;
            } else {
                var15 = -0.04755433917515264;
            }
        } else {
            if (input[2] > 42252.50000000001) {
                var15 = -0.03757443464896569;
            } else {
                var15 = -0.07089190995054127;
            }
        }
    }
    double var16;
    if (input[2] > 61398.00000000001) {
        if (input[3] > 0.000000000000000000000000000000000010000000180025095) {
            if (input[1] > 649.5000000000001) {
                var16 = 0.03773690488102314;
            } else {
                var16 = -0.06019794185518889;
            }
        } else {
            if (input[2] > 212429.00000000003) {
                var16 = 0.008719579545933252;
            } else {
                var16 = -0.07139273411581525;
            }
        }
    } else {
        if (input[4] > 382.50000000000006) {
            if (input[4] > 899.5000000000001) {
                var16 = 0.07778213812079526;
            } else {
                var16 = 0.011365644206562102;
            }
        } else {
            if (input[2] > 42252.50000000001) {
                var16 = -0.03530406342619362;
            } else {
                var16 = -0.07047121846406997;
            }
        }
    }
    double var17;
    if (input[2] > 61398.00000000001) {
        if (input[5] > 11.449510000000002) {
            if (input[7] > 0.11102800000000002) {
                var17 = -0.028053906914841283;
            } else {
                var17 = 0.04445172983000082;
            }
        } else {
            if (input[4] > 400.50000000000006) {
                var17 = 0.08448528590650206;
            } else {
                var17 = -0.03653508214467998;
            }
        }
    } else {
        if (input[4] > 382.50000000000006) {
            if (input[7] > 0.0008395000000000001) {
                var17 = 0.05755995386339644;
            } else {
                var17 = -0.03764175332640236;
            }
        } else {
            if (input[1] > 12753.000000000002) {
                var17 = 0.0022650945119603765;
            } else {
                var17 = -0.06759111724123312;
            }
        }
    }
    double var18;
    if (input[2] > 61398.00000000001) {
        if (input[3] > 1.5000000000000002) {
            if (input[5] > 140.5872495) {
                var18 = -0.0068377538800433076;
            } else {
                var18 = 0.05152409835222101;
            }
        } else {
            if (input[9] > 1388.295014) {
                var18 = 0.08354550772823044;
            } else {
                var18 = -0.010835960895385506;
            }
        }
    } else {
        if (input[4] > 382.50000000000006) {
            if (input[4] > 899.5000000000001) {
                var18 = 0.0753880748769033;
            } else {
                var18 = 0.009334938435956074;
            }
        } else {
            if (input[2] > 42252.50000000001) {
                var18 = -0.030189316748434492;
            } else {
                var18 = -0.06977971491894955;
            }
        }
    }
    double var19;
    if (input[2] > 48500.00000000001) {
        if (input[3] > 0.000000000000000000000000000000000010000000180025095) {
            if (input[1] > 649.5000000000001) {
                var19 = 0.031559232557661715;
            } else {
                var19 = -0.059266563145799915;
            }
        } else {
            if (input[2] > 212429.00000000003) {
                var19 = 0.0034417160116747194;
            } else {
                var19 = -0.06915330085542232;
            }
        }
    } else {
        if (input[4] > 449.50000000000006) {
            if (input[6] > 759.7618680000002) {
                var19 = 0.06637550296369447;
            } else {
                var19 = -0.0047114980931999215;
            }
        } else {
            if (input[4] > 382.50000000000006) {
                var19 = -0.0171684397434266;
            } else {
                var19 = -0.06832095366324319;
            }
        }
    }
    double var20;
    if (input[2] > 48500.00000000001) {
        if (input[3] > 0.000000000000000000000000000000000010000000180025095) {
            if (input[1] > 649.5000000000001) {
                var20 = 0.029598973322274926;
            } else {
                var20 = -0.057559041158889705;
            }
        } else {
            if (input[2] > 212429.00000000003) {
                var20 = 0.0023099957986935558;
            } else {
                var20 = -0.06678767853576562;
            }
        }
    } else {
        if (input[4] > 449.50000000000006) {
            if (input[7] > 0.0008395000000000001) {
                var20 = 0.054937325036984556;
            } else {
                var20 = -0.039263402215389515;
            }
        } else {
            if (input[4] > 335.50000000000006) {
                var20 = -0.028100702615289554;
            } else {
                var20 = -0.06833906165305316;
            }
        }
    }
    double var21;
    if (input[6] > 5.696735500000001) {
        if (input[6] > 17.297026500000005) {
            if (input[2] > 2079.5000000000005) {
                var21 = -1.3018576149622019;
            } else {
                var21 = -1.20444372540569;
            }
        } else {
            if (input[2] > 3110.0000000000005) {
                var21 = -1.2252136258974866;
            } else {
                var21 = -1.0176659575288551;
            }
        }
    } else {
        if (input[5] > 6.986470500000001) {
            if (input[4] > 17.500000000000004) {
                var21 = -1.2965519261974463;
            } else {
                var21 = -1.2028132150371467;
            }
        } else {
            if (input[4] > 48.50000000000001) {
                var21 = -1.2118964234829122;
            } else {
                var21 = -1.0034116701602118;
            }
        }
    }
    double var22;
    if (input[4] > 18.500000000000004) {
        if (input[6] > 17.297026500000005) {
            if (input[2] > 2079.5000000000005) {
                var22 = -0.08684319143153585;
            } else {
                var22 = 0.009319816203706487;
            }
        } else {
            if (input[5] > 7.071902000000001) {
                var22 = -0.08332990263174392;
            } else {
                var22 = 0.06354053576150641;
            }
        }
    } else {
        if (input[5] > 4.830381000000001) {
            if (input[2] > 3963.0000000000005) {
                var22 = 0.02676024180215307;
            } else {
                var22 = 0.17966547400447208;
            }
        } else {
            if (input[6] > 9.342212000000002) {
                var22 = 0.009169504928872868;
            } else {
                var22 = 0.17213796710047818;
            }
        }
    }
    double var23;
    if (input[4] > 18.500000000000004) {
        if (input[6] > 22.022223500000003) {
            if (input[4] > 30.500000000000004) {
                var23 = -0.08512312544872758;
            } else {
                var23 = 0.00884250530287556;
            }
        } else {
            if (input[5] > 7.709570500000001) {
                var23 = -0.08314622628449737;
            } else {
                var23 = 0.046904328472074916;
            }
        }
    } else {
        if (input[5] > 5.199647500000001) {
            if (input[2] > 3963.0000000000005) {
                var23 = 0.013691730467516386;
            } else {
                var23 = 0.15465727919899974;
            }
        } else {
            if (input[5] > 3.3127305000000002) {
                var23 = 0.11621751436927606;
            } else {
                var23 = 0.15399464707683916;
            }
        }
    }
    double var24;
    if (input[4] > 18.500000000000004) {
        if (input[6] > 22.022223500000003) {
            if (input[4] > 30.500000000000004) {
                var24 = -0.08235715240022681;
            } else {
                var24 = 0.010778185439965953;
            }
        } else {
            if (input[5] > 7.709570500000001) {
                var24 = -0.08011827490327252;
            } else {
                var24 = 0.04379114931542792;
            }
        }
    } else {
        if (input[5] > 5.199647500000001) {
            if (input[0] > 88831.50000000001) {
                var24 = -0.10253363827667328;
            } else {
                var24 = 0.046021401542858886;
            }
        } else {
            if (input[6] > 9.342212000000002) {
                var24 = 0.001598669612026387;
            } else {
                var24 = 0.12753220346512711;
            }
        }
    }
    double var25;
    if (input[4] > 18.500000000000004) {
        if (input[4] > 36.50000000000001) {
            if (input[6] > 19.691613500000006) {
                var25 = -0.08089082792899316;
            } else {
                var25 = -0.020635999290305226;
            }
        } else {
            if (input[2] > 5894.500000000001) {
                var25 = -0.033386345624600404;
            } else {
                var25 = 0.1062620147057613;
            }
        }
    } else {
        if (input[5] > 4.319784000000001) {
            if (input[2] > 3963.0000000000005) {
                var25 = 0.02365910109568972;
            } else {
                var25 = 0.14043844765206373;
            }
        } else {
            if (input[5] > 3.3127305000000002) {
                var25 = 0.09875486296075703;
            } else {
                var25 = 0.12188684254274972;
            }
        }
    }
    double var26;
    if (input[6] > 16.104794500000004) {
        if (input[2] > 2123.0000000000005) {
            if (input[6] > 44.619188) {
                var26 = -0.08039601430394164;
            } else {
                var26 = -0.056135254497151225;
            }
        } else {
            if (input[4] > 47.50000000000001) {
                var26 = -0.08044939420380702;
            } else {
                var26 = 0.1795095320263404;
            }
        }
    } else {
        if (input[5] > 6.986470500000001) {
            if (input[2] > 3963.0000000000005) {
                var26 = -0.05162611562196753;
            } else {
                var26 = 0.13179487480274285;
            }
        } else {
            if (input[9] > 54.51314000000001) {
                var26 = -0.0747296758867977;
            } else {
                var26 = 0.0942681604109557;
            }
        }
    }
    double var27;
    if (input[6] > 16.104794500000004) {
        if (input[2] > 3024.0000000000005) {
            if (input[0] > 33079.50000000001) {
                var27 = -0.04402799827784944;
            } else {
                var27 = -0.07850380632688403;
            }
        } else {
            if (input[4] > 47.50000000000001) {
                var27 = -0.07900694271997222;
            } else {
                var27 = 0.15081510467903375;
            }
        }
    } else {
        if (input[5] > 6.986470500000001) {
            if (input[2] > 3963.0000000000005) {
                var27 = -0.04826258110806661;
            } else {
                var27 = 0.1227351862000339;
            }
        } else {
            if (input[9] > 54.51314000000001) {
                var27 = -0.07112798824606563;
            } else {
                var27 = 0.08630807136761123;
            }
        }
    }
    double var28;
    if (input[6] > 16.104794500000004) {
        if (input[2] > 3110.0000000000005) {
            if (input[0] > 33079.50000000001) {
                var28 = -0.04172659939748318;
            } else {
                var28 = -0.07697883215794077;
            }
        } else {
            if (input[4] > 47.50000000000001) {
                var28 = -0.07728651068994179;
            } else {
                var28 = 0.1305264816768356;
            }
        }
    } else {
        if (input[5] > 6.136071500000001) {
            if (input[2] > 2726.0000000000005) {
                var28 = -0.0346795992670082;
            } else {
                var28 = 0.14454798512364153;
            }
        } else {
            if (input[9] > 54.51314000000001) {
                var28 = -0.06769734800414716;
            } else {
                var28 = 0.0825389525378511;
            }
        }
    }
    double var29;
    if (input[6] > 16.104794500000004) {
        if (input[2] > 3024.0000000000005) {
            if (input[7] > 0.0006235) {
                var29 = -0.07568540896190827;
            } else {
                var29 = -0.042021526860515225;
            }
        } else {
            if (input[4] > 47.50000000000001) {
                var29 = -0.07564439557402228;
            } else {
                var29 = 0.12286362059621031;
            }
        }
    } else {
        if (input[5] > 6.136071500000001) {
            if (input[2] > 2726.0000000000005) {
                var29 = -0.03224342056754445;
            } else {
                var29 = 0.13515549751617167;
            }
        } else {
            if (input[9] > 54.51314000000001) {
                var29 = -0.06488854278354925;
            } else {
                var29 = 0.07667164174306762;
            }
        }
    }
    double var30;
    if (input[4] > 36.50000000000001) {
        if (input[6] > 2.3227620000000004) {
            if (input[7] > 0.0004155) {
                var30 = -0.073419245927594;
            } else {
                var30 = -0.033424823669730284;
            }
        } else {
            var30 = 0.11889344149412198;
        }
    } else {
        if (input[5] > 4.830381000000001) {
            if (input[2] > 3963.0000000000005) {
                var30 = -0.032796702229882256;
            } else {
                var30 = 0.10969058349222992;
            }
        } else {
            if (input[5] > 3.2494915000000004) {
                var30 = 0.054088135441091395;
            } else {
                var30 = 0.09059290482476726;
            }
        }
    }
    double var31;
    if (input[4] > 36.50000000000001) {
        if (input[6] > 19.691613500000006) {
            if (input[7] > 0.0003940000000000001) {
                var31 = -0.0737519110305914;
            } else {
                var31 = -0.044951793401313896;
            }
        } else {
            if (input[4] > 70.50000000000001) {
                var31 = -0.0738874057763604;
            } else {
                var31 = 0.014094402331207224;
            }
        }
    } else {
        if (input[5] > 4.830381000000001) {
            if (input[2] > 3963.0000000000005) {
                var31 = -0.03091426461903837;
            } else {
                var31 = 0.10263057891807288;
            }
        } else {
            if (input[5] > 3.2494915000000004) {
                var31 = 0.050562216114537144;
            } else {
                var31 = 0.08651592761277796;
            }
        }
    }
    double var32;
    if (input[4] > 36.50000000000001) {
        if (input[6] > 19.691613500000006) {
            if (input[7] > 0.0003940000000000001) {
                var32 = -0.07270523136766224;
            } else {
                var32 = -0.043120550911670025;
            }
        } else {
            if (input[4] > 70.50000000000001) {
                var32 = -0.07194613201919973;
            } else {
                var32 = 0.014073632786440825;
            }
        }
    } else {
        if (input[5] > 4.830381000000001) {
            if (input[2] > 3963.0000000000005) {
                var32 = -0.029077982028805772;
            } else {
                var32 = 0.0962170032068135;
            }
        } else {
            if (input[5] > 3.2494915000000004) {
                var32 = 0.04685149751548478;
            } else {
                var32 = 0.08322088304425376;
            }
        }
    }
    double var33;
    if (input[4] > 36.50000000000001) {
        if (input[6] > 19.691613500000006) {
            if (input[7] > 0.0003940000000000001) {
                var33 = -0.07178829728825781;
            } else {
                var33 = -0.04127346103919076;
            }
        } else {
            if (input[6] > 2.3227620000000004) {
                var33 = -0.021495740189679577;
            } else {
                var33 = 0.10464236383337773;
            }
        }
    } else {
        if (input[5] > 4.830381000000001) {
            if (input[2] > 3963.0000000000005) {
                var33 = -0.0271768160971207;
            } else {
                var33 = 0.08689633437832667;
            }
        } else {
            if (input[5] > 3.2494915000000004) {
                var33 = 0.04323588977519088;
            } else {
                var33 = 0.0799834318838706;
            }
        }
    }
    double var34;
    if (input[4] > 36.50000000000001) {
        if (input[6] > 19.691613500000006) {
            if (input[7] > 0.0003940000000000001) {
                var34 = -0.07089600694183693;
            } else {
                var34 = -0.039255430994153725;
            }
        } else {
            if (input[4] > 70.50000000000001) {
                var34 = -0.06928183523656467;
            } else {
                var34 = 0.01247396560424777;
            }
        }
    } else {
        if (input[5] > 10.065337500000002) {
            if (input[2] > 4083.0000000000005) {
                var34 = -0.06983205620333137;
            } else {
                var34 = 0.06500432448217074;
            }
        } else {
            if (input[2] > 3553.0000000000005) {
                var34 = 0.030606204038879387;
            } else {
                var34 = 0.08331616637206818;
            }
        }
    }
    double var35;
    if (input[4] > 36.50000000000001) {
        if (input[6] > 19.691613500000006) {
            if (input[7] > 0.0003940000000000001) {
                var35 = -0.07008154531161291;
            } else {
                var35 = -0.0371977781631247;
            }
        } else {
            if (input[4] > 70.50000000000001) {
                var35 = -0.06767574494298875;
            } else {
                var35 = 0.012312816153227686;
            }
        }
    } else {
        if (input[5] > 4.830381000000001) {
            if (input[2] > 3963.0000000000005) {
                var35 = -0.02576333083377699;
            } else {
                var35 = 0.0782131125247337;
            }
        } else {
            if (input[9] > 30.7711645) {
                var35 = 0.14812305193120687;
            } else {
                var35 = 0.056024232641443676;
            }
        }
    }
    double var36;
    if (input[6] > 16.830654000000003) {
        if (input[2] > 3024.0000000000005) {
            if (input[0] > 26234.500000000004) {
                var36 = -0.02497458474041891;
            } else {
                var36 = -0.07045931076971966;
            }
        } else {
            if (input[4] > 47.50000000000001) {
                var36 = -0.0688180388843143;
            } else {
                var36 = 0.09049499472573558;
            }
        }
    } else {
        if (input[5] > 9.531997000000002) {
            if (input[2] > 7172.000000000001) {
                var36 = -0.065829729643131;
            } else {
                var36 = 0.02459128327289721;
            }
        } else {
            if (input[2] > 3110.0000000000005) {
                var36 = 0.029867477445820658;
            } else {
                var36 = 0.08038281854692897;
            }
        }
    }
    double var37;
    if (input[4] > 37.50000000000001) {
        if (input[6] > 44.619188) {
            if (input[7] > 0.0003940000000000001) {
                var37 = -0.07067432290296274;
            } else {
                var37 = -0.04428921150396031;
            }
        } else {
            if (input[0] > 26234.500000000004) {
                var37 = 0.03155371333017777;
            } else {
                var37 = -0.041928776766246956;
            }
        }
    } else {
        if (input[5] > 3.3127305000000002) {
            if (input[2] > 3110.0000000000005) {
                var37 = -0.008574516375089382;
            } else {
                var37 = 0.08313470083493263;
            }
        } else {
            if (input[6] > 8.644528000000003) {
                var37 = 0.02106579922845114;
            } else {
                var37 = 0.07373827758837519;
            }
        }
    }
    double var38;
    if (input[5] > 9.531997000000002) {
        if (input[2] > 4083.0000000000005) {
            if (input[5] > 10.612240500000002) {
                var38 = -0.0710583344013385;
            } else {
                var38 = -0.03825658029424414;
            }
        } else {
            if (input[9] > 18.087546500000006) {
                var38 = -0.040713918020204014;
            } else {
                var38 = 0.08899075825981528;
            }
        }
    } else {
        if (input[4] > 68.50000000000001) {
            if (input[0] > 50197.50000000001) {
                var38 = -0.03178855152360853;
            } else {
                var38 = -0.07121460460419429;
            }
        } else {
            if (input[5] > 2.8676115) {
                var38 = 0.019877307912275544;
            } else {
                var38 = 0.07386933123760102;
            }
        }
    }
    double var39;
    if (input[5] > 9.531997000000002) {
        if (input[2] > 3024.0000000000005) {
            if (input[4] > 19.500000000000004) {
                var39 = -0.06963676759584744;
            } else {
                var39 = -0.02252655226349723;
            }
        } else {
            if (input[4] > 46.50000000000001) {
                var39 = -0.07349484327878501;
            } else {
                var39 = 0.0618929043304864;
            }
        }
    } else {
        if (input[4] > 70.50000000000001) {
            if (input[2] > 233362.50000000003) {
                var39 = -0.03429008323351786;
            } else {
                var39 = -0.07177946050997595;
            }
        } else {
            if (input[5] > 2.8676115) {
                var39 = 0.01819559321909256;
            } else {
                var39 = 0.07229238972773126;
            }
        }
    }
    double var40;
    if (input[5] > 9.531997000000002) {
        if (input[2] > 4083.0000000000005) {
            if (input[5] > 10.612240500000002) {
                var40 = -0.07006005556459738;
            } else {
                var40 = -0.03330317363299668;
            }
        } else {
            if (input[9] > 18.087546500000006) {
                var40 = -0.03958682424709912;
            } else {
                var40 = 0.08197362787070427;
            }
        }
    } else {
        if (input[4] > 68.50000000000001) {
            if (input[9] > 106.52895000000001) {
                var40 = -0.0734894317207792;
            } else {
                var40 = -0.043802637420685;
            }
        } else {
            if (input[5] > 2.8676115) {
                var40 = 0.016856479912226763;
            } else {
                var40 = 0.07018372278295527;
            }
        }
    }
    double var41;
    if (input[6] > 5.206955000000001) {
        if (input[2] > 113006.50000000001) {
            if (input[7] > 0.05684150000000001) {
                var41 = -0.6884449963373758;
            } else {
                var41 = -0.8450156760972772;
            }
        } else {
            if (input[4] > 673.5000000000001) {
                var41 = -0.8691323367775418;
            } else {
                var41 = -0.6674127893744108;
            }
        }
    } else {
        if (input[5] > 7.151607000000001) {
            if (input[2] > 191115.00000000003) {
                var41 = -0.8821291920640554;
            } else {
                var41 = -0.6822949633692894;
            }
        } else {
            if (input[4] > 48.50000000000001) {
                var41 = -0.7156041828947625;
            } else {
                var41 = -0.879721536030486;
            }
        }
    }
    double var42;
    if (input[6] > 5.206955000000001) {
        if (input[2] > 110441.50000000001) {
            if (input[7] > 0.05684150000000001) {
                var42 = 0.06929790486546186;
            } else {
                var42 = -0.07113763483158587;
            }
        } else {
            if (input[4] > 840.5000000000001) {
                var42 = -0.10800056589253702;
            } else {
                var42 = 0.08620524663715501;
            }
        }
    } else {
        if (input[5] > 7.151607000000001) {
            if (input[2] > 191115.00000000003) {
                var42 = -0.10722506502110346;
            } else {
                var42 = 0.07602021137844377;
            }
        } else {
            if (input[4] > 48.50000000000001) {
                var42 = 0.04439001642684882;
            } else {
                var42 = -0.10292241346410286;
            }
        }
    }
    double var43;
    if (input[6] > 5.696735500000001) {
        if (input[2] > 212429.00000000003) {
            if (input[7] > 0.04508550000000001) {
                var43 = 0.058729245201413864;
            } else {
                var43 = -0.08862860334823615;
            }
        } else {
            if (input[4] > 673.5000000000001) {
                var43 = -0.08961267717170429;
            } else {
                var43 = 0.07485021466391711;
            }
        }
    } else {
        if (input[5] > 4.280187000000001) {
            if (input[0] > 24769.000000000004) {
                var43 = -0.10852958218811065;
            } else {
                var43 = -0.0009228702149826752;
            }
        } else {
            if (input[4] > 50.50000000000001) {
                var43 = 0.08294644386448337;
            } else {
                var43 = -0.0994332318880098;
            }
        }
    }
    double var44;
    if (input[6] > 5.206955000000001) {
        if (input[2] > 212429.00000000003) {
            if (input[7] > 0.030828000000000005) {
                var44 = 0.04308364975831518;
            } else {
                var44 = -0.08723957423600653;
            }
        } else {
            if (input[4] > 673.5000000000001) {
                var44 = -0.08318518395633946;
            } else {
                var44 = 0.06691583637398932;
            }
        }
    } else {
        if (input[5] > 7.151607000000001) {
            if (input[2] > 191115.00000000003) {
                var44 = -0.09450695163813923;
            } else {
                var44 = 0.06984988168541045;
            }
        } else {
            if (input[4] > 48.50000000000001) {
                var44 = 0.03846320642814193;
            } else {
                var44 = -0.08848032913398297;
            }
        }
    }
    double var45;
    if (input[4] > 15.500000000000002) {
        if (input[2] > 212429.00000000003) {
            if (input[7] > 0.026911) {
                var45 = 0.037819490426641476;
            } else {
                var45 = -0.08320107975999319;
            }
        } else {
            if (input[4] > 875.5000000000001) {
                var45 = -0.09186438094548409;
            } else {
                var45 = 0.058530347013246026;
            }
        }
    } else {
        if (input[5] > 4.994558500000001) {
            if (input[6] > 1.1997820000000001) {
                var45 = 0.0015440257759451095;
            } else {
                var45 = -0.1036201628432945;
            }
        } else {
            if (input[5] > 3.3127305000000002) {
                var45 = -0.07014045181343175;
            } else {
                var45 = -0.09420832095050939;
            }
        }
    }
    double var46;
    if (input[6] > 5.206955000000001) {
        if (input[2] > 110441.50000000001) {
            if (input[7] > 0.0512975) {
                var46 = 0.049419272744937445;
            } else {
                var46 = -0.054067564320297946;
            }
        } else {
            if (input[4] > 875.5000000000001) {
                var46 = -0.0861509906712202;
            } else {
                var46 = 0.06051183571903801;
            }
        }
    } else {
        if (input[5] > 7.151607000000001) {
            if (input[2] > 191115.00000000003) {
                var46 = -0.08635354075774189;
            } else {
                var46 = 0.0654097132578033;
            }
        } else {
            if (input[4] > 50.50000000000001) {
                var46 = 0.051553332861456726;
            } else {
                var46 = -0.07900358030333379;
            }
        }
    }
    double var47;
    if (input[4] > 14.500000000000002) {
        if (input[0] > 14768.000000000002) {
            if (input[2] > 279118.00000000006) {
                var47 = -0.08291066364713427;
            } else {
                var47 = -0.008319029138212081;
            }
        } else {
            if (input[9] > 880.8969155000001) {
                var47 = -0.08003193207772982;
            } else {
                var47 = 0.04550676360159992;
            }
        }
    } else {
        if (input[5] > 5.045862500000001) {
            if (input[6] > 1.1997820000000001) {
                var47 = -0.00043801377487291936;
            } else {
                var47 = -0.09790496911203461;
            }
        } else {
            if (input[5] > 3.2494915000000004) {
                var47 = -0.06515340534956986;
            } else {
                var47 = -0.08675271662409456;
            }
        }
    }
    double var48;
    if (input[6] > 4.758307500000002) {
        if (input[0] > 14768.000000000002) {
            if (input[2] > 279118.00000000006) {
                var48 = -0.07960164914916651;
            } else {
                var48 = -0.004317502097426813;
            }
        } else {
            if (input[9] > 880.8969155000001) {
                var48 = -0.07554479587828665;
            } else {
                var48 = 0.04284310833199953;
            }
        }
    } else {
        if (input[5] > 4.0008065) {
            if (input[6] > 1.9347430000000003) {
                var48 = 0.008039559500432718;
            } else {
                var48 = -0.08384726426983605;
            }
        } else {
            if (input[4] > 50.50000000000001) {
                var48 = 0.052672871392071954;
            } else {
                var48 = -0.08038836239757427;
            }
        }
    }
    double var49;
    if (input[4] > 14.500000000000002) {
        if (input[0] > 19339.000000000004) {
            if (input[1] > 10742.500000000002) {
                var49 = -0.08062975557543337;
            } else {
                var49 = -0.01627298977586732;
            }
        } else {
            if (input[9] > 880.8969155000001) {
                var49 = -0.07247352442030612;
            } else {
                var49 = 0.038146847612029966;
            }
        }
    } else {
        if (input[5] > 4.994558500000001) {
            if (input[0] > 18518.500000000004) {
                var49 = -0.09346292469751571;
            } else {
                var49 = -0.00015478192974005675;
            }
        } else {
            if (input[5] > 3.2494915000000004) {
                var49 = -0.05766278297414004;
            } else {
                var49 = -0.08165675957227651;
            }
        }
    }
    double var50;
    if (input[6] > 3.979715) {
        if (input[0] > 19339.000000000004) {
            if (input[2] > 279118.00000000006) {
                var50 = -0.07881576226880382;
            } else {
                var50 = -0.01377228311934397;
            }
        } else {
            if (input[9] > 921.1803175000001) {
                var50 = -0.07159511229150653;
            } else {
                var50 = 0.034769036002474545;
            }
        }
    } else {
        if (input[5] > 4.0008065) {
            if (input[6] > 1.9347430000000003) {
                var50 = 0.011145941968075819;
            } else {
                var50 = -0.07992317820086622;
            }
        } else {
            if (input[9] > 54.51314000000001) {
                var50 = 0.07947486251833603;
            } else {
                var50 = -0.07642695204494789;
            }
        }
    }
    double var51;
    if (input[4] > 14.500000000000002) {
        if (input[0] > 13302.500000000002) {
            if (input[2] > 279118.00000000006) {
                var51 = -0.06901955208566427;
            } else {
                var51 = -0.0006828575723448914;
            }
        } else {
            if (input[9] > 617.0577100000002) {
                var51 = -0.04714031759705603;
            } else {
                var51 = 0.0372391840744026;
            }
        }
    } else {
        if (input[5] > 3.2494915000000004) {
            if (input[2] > 3783.0000000000005) {
                var51 = -0.02582445967847929;
            } else {
                var51 = -0.08865555692769346;
            }
        } else {
            if (input[6] > 5.206955000000001) {
                var51 = -0.10416028598007093;
            } else {
                var51 = -0.07700246739538129;
            }
        }
    }
    double var52;
    if (input[6] > 3.979715) {
        if (input[0] > 19339.000000000004) {
            if (input[5] > 1.6938750000000002) {
                var52 = -0.06086930950507438;
            } else {
                var52 = 0.09772744385254598;
            }
        } else {
            if (input[2] > 3024.0000000000005) {
                var52 = 0.032774660941448326;
            } else {
                var52 = -0.05143710513785748;
            }
        }
    } else {
        if (input[5] > 4.0008065) {
            if (input[6] > 1.9347430000000003) {
                var52 = 0.011744531881532242;
            } else {
                var52 = -0.0780054637055759;
            }
        } else {
            if (input[4] > 50.50000000000001) {
                var52 = 0.05375055136975729;
            } else {
                var52 = -0.07263999817822392;
            }
        }
    }
    double var53;
    if (input[6] > 3.979715) {
        if (input[0] > 19803.500000000004) {
            if (input[1] > 10742.500000000002) {
                var53 = -0.0759510280148229;
            } else {
                var53 = -0.003990997928597933;
            }
        } else {
            if (input[9] > 921.1803175000001) {
                var53 = -0.06627744308370946;
            } else {
                var53 = 0.028912141261699914;
            }
        }
    } else {
        if (input[6] > 1.5941135000000002) {
            if (input[8] > 0.49337250000000005) {
                var53 = -0.06559740863068302;
            } else {
                var53 = -0.001198371599413505;
            }
        } else {
            if (input[5] > 7.958667500000002) {
                var53 = -0.11415512349024273;
            } else {
                var53 = -0.07542940544665261;
            }
        }
    }
    double var54;
    if (input[4] > 14.500000000000002) {
        if (input[0] > 23750.500000000004) {
            if (input[1] > 10593.000000000002) {
                var54 = -0.07374454706548754;
            } else {
                var54 = -0.010187303329140472;
            }
        } else {
            if (input[9] > 921.1803175000001) {
                var54 = -0.05982252420745511;
            } else {
                var54 = 0.02686716170596769;
            }
        }
    } else {
        if (input[2] > 4359.000000000001) {
            if (input[0] > 4879.500000000001) {
                var54 = -0.06454027225781794;
            } else {
                var54 = -0.0017556170195500557;
            }
        } else {
            if (input[6] > 5.206955000000001) {
                var54 = -0.09807886008082733;
            } else {
                var54 = -0.07381613366984235;
            }
        }
    }
    double var55;
    if (input[4] > 14.500000000000002) {
        if (input[2] > 212429.00000000003) {
            if (input[7] > 0.026911) {
                var55 = 0.03420263821659944;
            } else {
                var55 = -0.06051568285961082;
            }
        } else {
            if (input[2] > 2596.0000000000005) {
                var55 = 0.033119393482601935;
            } else {
                var55 = -0.049280247536445394;
            }
        }
    } else {
        if (input[5] > 3.2494915000000004) {
            if (input[6] > 1.1997820000000001) {
                var55 = -0.017033524432216337;
            } else {
                var55 = -0.0811823934649557;
            }
        } else {
            if (input[1] > 49314.00000000001) {
                var55 = -0.029751254560718723;
            } else {
                var55 = -0.07330744460152482;
            }
        }
    }
    double var56;
    if (input[6] > 3.979715) {
        if (input[0] > 19803.500000000004) {
            if (input[1] > 10742.500000000002) {
                var56 = -0.07090790494689352;
            } else {
                var56 = -0.0019241769286767213;
            }
        } else {
            if (input[2] > 3024.0000000000005) {
                var56 = 0.02642904775123947;
            } else {
                var56 = -0.04622517891372759;
            }
        }
    } else {
        if (input[6] > 1.5941135000000002) {
            if (input[8] > 0.49337250000000005) {
                var56 = -0.06116377296817546;
            } else {
                var56 = 0.005388265205968738;
            }
        } else {
            if (input[5] > 7.958667500000002) {
                var56 = -0.10766375935535077;
            } else {
                var56 = -0.07238979824003963;
            }
        }
    }
    double var57;
    if (input[6] > 3.3960305000000006) {
        if (input[0] > 23750.500000000004) {
            if (input[5] > 1.6938750000000002) {
                var57 = -0.05995075184459431;
            } else {
                var57 = 0.0749688687189252;
            }
        } else {
            if (input[2] > 3024.0000000000005) {
                var57 = 0.023129288858553254;
            } else {
                var57 = -0.04316601010976841;
            }
        }
    } else {
        if (input[6] > 1.5941135000000002) {
            if (input[8] > 0.367964) {
                var57 = -0.05042491829778546;
            } else {
                var57 = 0.018846307651224213;
            }
        } else {
            if (input[2] > 32096.000000000004) {
                var57 = -0.08350878498790035;
            } else {
                var57 = -0.06939139269014492;
            }
        }
    }
    double var58;
    if (input[4] > 11.500000000000002) {
        if (input[0] > 23750.500000000004) {
            if (input[1] > 10593.000000000002) {
                var58 = -0.0690023884202264;
            } else {
                var58 = -0.006632160991429778;
            }
        } else {
            if (input[9] > 921.1803175000001) {
                var58 = -0.0568775071476128;
            } else {
                var58 = 0.020081949861121374;
            }
        }
    } else {
        if (input[4] > 8.500000000000002) {
            if (input[2] > 24091.500000000004) {
                var58 = -0.07120028482256725;
            } else {
                var58 = -0.020269971067283336;
            }
        } else {
            if (input[5] > 5.602540500000001) {
                var58 = -0.0553600454492768;
            } else {
                var58 = -0.07281626714532692;
            }
        }
    }
    double var59;
    if (input[6] > 1.8283830000000003) {
        if (input[0] > 23750.500000000004) {
            if (input[1] > 10593.000000000002) {
                var59 = -0.0675107441864765;
            } else {
                var59 = -0.005731854072531079;
            }
        } else {
            if (input[2] > 3553.0000000000005) {
                var59 = 0.020582025415025868;
            } else {
                var59 = -0.03621816259951786;
            }
        }
    } else {
        if (input[3] > 4.500000000000001) {
            var59 = 0.0023895541772036375;
        } else {
            if (input[7] > 0.00033750000000000007) {
                var59 = -0.07318494992103695;
            } else {
                var59 = -0.054358131182223324;
            }
        }
    }
    double var60;
    if (input[4] > 11.500000000000002) {
        if (input[0] > 23750.500000000004) {
            if (input[1] > 10593.000000000002) {
                var60 = -0.06506728468844651;
            } else {
                var60 = -0.0052968028612331314;
            }
        } else {
            if (input[9] > 1221.2570950000002) {
                var60 = -0.07070242602840336;
            } else {
                var60 = 0.017158941925863744;
            }
        }
    } else {
        if (input[4] > 8.500000000000002) {
            if (input[0] > 4745.500000000001) {
                var60 = -0.06807702273045411;
            } else {
                var60 = -0.015255719659520007;
            }
        } else {
            if (input[5] > 5.602540500000001) {
                var60 = -0.05059333355069645;
            } else {
                var60 = -0.0719197040966381;
            }
        }
    }
    double arr[] = {var1 + var2 + var3 + var4 + var5 + var6 + var7 + var8 + var9 + var10 + var11 + var12 + var13 + var14 + var15 + var16 + var17 + var18 + var19 + var20, var21 + var22 + var23 + var24 + var25 + var26 + var27 + var28 + var29 + var30 + var31 + var32 + var33 + var34 + var35 + var36 + var37 + var38 + var39 + var40, var41 + var42 + var43 + var44 + var45 + var46 + var47 + var48 + var49 + var50 + var51 + var52 + var53 + var54 + var55 + var56 + var57 + var58 + var59 + var60};
    softmax(arr, 3, var0);
    memcpy(output, var0, 3 * sizeof(double));
}

// int spmv_algo; // -1- cusparse 0-cusparse 1-scaler 2-adaptive
// int spgemm_algo; // -1-old 205 900   0-spECK 270  1-upper 207   2-opsparse 220 420

int OptAlgo::best_spgemm_algo(OptAlgo another) {
    //2 - 23是特征，28是label
    //2 - 20，去掉grid aprap flops
    double data[19] = {
        (double)this->M,
        (double)this->N,
        (double)this->nnz,
        (double)this->min,
        (double)this->max,
        (double)this->mean,
        (double)this->variance,
        (double)this->density,
        (double)this->cov,
        (double)this->max_mu,

        (double)another.N,
        (double)another.nnz,
        (double)another.min,
        (double)another.max,
        (double)another.mean,
        (double)another.variance,
        (double)another.density,
        (double)another.cov,
        (double)another.max_mu,

        // grid aprap flops

    };
    double output[3];

    score310(data, output);

    int category;
    double maxi = output[0] > output[1] ? output[0] : (output[1] > output[2] ? output[1] : output[2]);
    if(maxi == output[0])
        category = 0;
    else if(maxi == output[1])
        category = 1;
    else if(maxi == output[2])
        category = 2;
    return category;
};

int OptAlgo::best_spmv_algo() {
    //1 - 10，去掉grid aprap flops
    double data[10] = {
        (double)this->M,
        (double)this->N,
        (double)this->nnz,
        (double)this->min,
        (double)this->max,
        (double)this->mean,
        (double)this->variance,
        (double)this->density,
        (double)this->cov,
        (double)this->max_mu
    };
    double output[3];

    score320_spmv(data, output);

    int category;
    double maxi = output[0] > output[1] ? output[0] : (output[1] > output[2] ? output[1] : output[2]);
    if(maxi == output[0])
        category = 0;
    else if(maxi == output[1])
        category = 1;
    else if(maxi == output[2])
        category = 2;
    return category;
};

// 1. 计算矩阵特征
void OptAlgo::setup_1(int _M,int _N,int _nnz,int *r,int *c,double *v) 
{
    if(this->M != 0) return;

    this->M = _M;
    this->N = _N;
    this->nnz = _nnz;
    this->max = 0;
    this->min = 2147483647;

    this->mean = this->nnz / this->M;
    this->variance = 0.0;

    for (int i = 0; i < _M; i++)
    {
        
        int nnz_row = r[i+1] - r[i];
        this->max = (nnz_row > this->max) ? nnz_row : this->max;
        
        this->variance += (nnz_row - this->mean) * (nnz_row - this->mean);
    }
    this->max_mu = this->max - this->mean;
    this->variance /= (double)_M;
    this->cov= sqrt(this->variance) / this->mean;
};

#define RET_TO_OLD

// TODO 利用网格层次减少预测次数
// integer index of the AMG level to which the matrix belongs (fine level has index 0, the next coarse level has index 1, and so on)
// int amg_level_index;

void OptAlgo::setup_2(OptAlgo &another)
{
#ifdef RET_TO_OLD
    this->spgemm_algo = -1;
#else
    this->spgemm_algo = this->best_spgemm_algo(another);
#endif
}

void OptAlgo::setup_3() {
#ifdef RET_TO_OLD
    this->spmv_algo = -1;
#else
    this->spmv_algo = this->best_spmv_algo();
#endif
}